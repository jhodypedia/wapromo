<div class="d-flex justify-content-between align-items-center mb-3">
  <h4 class="mb-0"><i class="fa fa-mobile text-primary me-2"></i>Generate Nomor HP</h4>
</div>

<% if (error) { %>
  <div class="alert alert-danger"><%= error %></div>
<% } %>

<form action="/generate" method="post" class="mb-3">
  <div class="row">
    <div class="col-md-4 mb-3">
      <label class="form-label">Operator</label>
      <select name="operator" class="form-select" required>
        <% operators.forEach(op => { %>
          <option value="<%= op %>"><%= op.toUpperCase() %></option>
        <% }) %>
      </select>
    </div>
    <div class="col-md-4 mb-3">
      <label class="form-label">Jumlah</label>
      <input type="number" name="count" class="form-control" value="10" required>
    </div>
    <div class="col-md-4 mb-3">
      <label class="form-label">Panjang Nomor</label>
      <input type="number" name="length" class="form-control" value="12" required>
    </div>
  </div>
  <div class="text-end">
    <button class="btn btn-primary"><i class="fa fa-bolt me-2"></i>Generate</button>
  </div>
</form>

<% if (numbers && numbers.length > 0) { %>
  <div class="mb-3">
    <label class="form-label">Hasil</label>
    <div class="copy-wrapper">
      <textarea id="generatedNumbers" rows="10" class="form-control"><%- numbers.join("\n") %></textarea>
      <div class="copy-actions">
        <button type="button" class="btn btn-outline-secondary btn-sm mb-2 w-100" onclick="copyNumbers()">
          <i class="fa fa-copy"></i> Copy
        </button>
        <button type="button" class="btn btn-outline-primary btn-sm w-100" onclick="downloadNumbers()">
          <i class="fa fa-download"></i> Download
        </button>
      </div>
    </div>
  </div>
<% } %>

<script>
  function copyNumbers() {
    const textarea = document.getElementById("generatedNumbers");
    textarea.select();
    textarea.setSelectionRange(0, 99999); // support mobile
    document.execCommand("copy");
    alert("Nomor berhasil dicopy ke clipboard!");
  }

  function downloadNumbers() {
    const text = document.getElementById("generatedNumbers").value;
    const blob = new Blob([text], { type: "text/plain" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "nomor_generate.txt";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }
</script>
